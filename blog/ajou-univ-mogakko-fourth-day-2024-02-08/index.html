<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.13.1"/><style data-href="/styles.a2bd8c38b53ecb10eeb4.css" data-identity="gatsby-global-css">@import url(https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;900&display=swap);.layout-module--container--78b04{font-family:Noto Sans KR,sans-serif;margin:auto;max-width:1280px;min-width:320px;overflow:auto}.layout-module--link-text--246e7{color:#24292f;text-decoration:none}.layout-module--nav-links--1113b{display:flex;list-style:none;padding-left:0}.layout-module--nav-link-item--a5f0a{padding-right:2rem}.layout-module--site-header--d0ab8{background:#24292f;font-family:Noto Sans KR,sans-serif;margin:3rem 0;padding:1rem 0 .1rem 1rem}.layout-module--site-header--d0ab8 .layout-module--link-text--246e7{color:#fff}.layout-module--site-title--e4dea{font-size:3rem;font-weight:700}.layout-module--page-heading--83cb2{color:#24292f}.layout-module--articleStyle--05fbf{border-bottom:1px solid grey}.video-module--video-wrapper--8f25c{height:0;padding-bottom:56.25%;position:relative}.video-module--video-wrapper--8f25c iframe{height:100%;left:0;position:absolute;top:0;width:100%}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><script>
  
  function gaOptout(){document.cookie=disableStr+'=true; expires=Thu, 31 Dec 2099 23:59:59 UTC;path=/',window[disableStr]=!0}var gaProperty='GTM-T2RJJWHT',disableStr='ga-disable-'+gaProperty;document.cookie.indexOf(disableStr+'=true')>-1&&(window[disableStr]=!0);
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'GTM-T2RJJWHT', 'auto', {});
      ga('set', 'anonymizeIp', true);
      
      
      
      
      }</script><title data-gatsby-head="true">아주대 모각소 4일차 - 모바일 앱 푸시 알람에도 우선순위가 있다 | Joe&#x27;s Blog</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="layout-module--container--78b04"><header class="layout-module--site-header--d0ab8"><a class="layout-module--link-text--246e7" href="/"><span class="layout-module--site-title--e4dea">Joe&#x27;s Blog</span></a><nav><ul class="layout-module--nav-links--1113b"><li class="layout-module--nav-link-item--a5f0a"><a class="layout-module--link-text--246e7" href="/">Main</a></li><li class="layout-module--nav-link-item--a5f0a"><a class="layout-module--link-text--246e7" href="/about/">About</a></li><li class="layout-module--nav-link-item--a5f0a"><a href="https://github.com/ussr1285" class="layout-module--link-text--246e7">Github</a></li><li class="layout-module--nav-link-item--a5f0a"><a class="layout-module--link-text--246e7" href="/guestbook/">Guestbook</a></li><li class="layout-module--nav-link-item--a5f0a"><a href="https://minjaegoogling.notion.site/fb5067a26b514e6580519523e319a5f6?pvs=4" class="layout-module--link-text--246e7">My Googling</a></li></ul></nav></header><main><h1 class="layout-module--page-heading--83cb2">아주대 모각소 4일차 - 모바일 앱 푸시 알람에도 우선순위가 있다</h1><p>군에 가기 전부터 지금까지 가족의 요청으로 모바일 웹뷰 앱 관련해서 일을 가끔 하고 있다.
군에 가기 전에는 React Native Expo로 직접 웹뷰 앱을 개발하서 사용하였었는데, 군에 있는 동안 React Native Expo의 체계가 상당히 많이 바뀌어서 기존 코드로는 앱을 빌드할 수 없는 상황이 되어버렸다. 그래서 내가 군에 있는 동안 다른 웹뷰 프레임워크를 도입하게 되었다고 한다.
그래서 전역 후, 그 새로운 웹뷰 프레임워크에 맞춰서 모바일 앱을 출시하게 되었다.</p>
<p>그렇게 활용되고 있는 모바일 웹뷰 앱 중 하나가 푸시 알림을 적극 활용하는데, 그 푸시 알림이 일정하지 않게 사람들에게 도착한다하여 문제가 되었다.
예전에 개발했던 방식이 구글 firebase와 Apple 푸시 관련 서비스에 직접 푸시 알림을 요청했었는데, 이번에는 OneSignal 이라는 푸시를 더 간편하게 보낼 수 있는 서비스를 활용하게 되었다. 안드로이드랑 애플 쪽 푸시 알림을 OneSignal이 중계해서 더 쉽게 한방에 보내주는 듯한 서비스다.</p>
<p>근데 그렇게 해놓으니 푸시 도착하는 시간이 휴대폰마다 제각각 다른 것이 아닌가?
그래서 이번 모각소 시간에 한번 찾아보았다.</p>
<p>그래서 일단 <a href="https://documentation.onesignal.com/docs/notifications-delayed">OneSignal Delayed</a> 공식 문서에 가서 보았더니, 이유가 될만한 것이 상당히 많았다.
첫째, 받는 사람의 네트워크 문제일 수가 있다.
둘째, 자주 사용하지 않는 앱이라 알림 권한이 삭제된 것일 수도 있다.
셋째, 푸시 알람의 우선순위가 문제일 수도 있다.
등등.. 여러 이유가 있어 하나하나 살펴보았다.</p>
<p>먼저 네트워크 문제를 확인하기 위해 같은 네트워크 상에 있는 휴대폰들에 앱을 설치하고 알림 권한도 허용하고 푸시를 날려본 결과, 푸시 알림이 거의 잘 도착했지만 한 사람 휴대폰에서는 푸시 알림이 울리지 않았다.
그래서 그 휴대폰 해당 모바일 앱 권한을 확인해봤는데 권한이 허용되어있었다.
게다가 그 모바일 앱은 출시한지 6개월이 되지 않았다. (앱을 사용을 몇개월 동안 안해야 권한이 삭제된다고 한다.)</p>
<p>그래서 우선순위인 것 같아서 이곳 저곳 영어로도 검색해보기도 한 결과 뭔가 푸시 알림에 우선순위의 속성이 있는 것이 확실해졌다.</p>
<p>현재 푸시 알람을 보내는 방식이, 따로 제작한 관리자 웹사이지에서 OneSignal API로 OneSignal에다가 어떤 알림을 보낼지 날려서, 다시 OneSignal에서 구글과 애플 알림 관련 서비스에 날리고, 거기서 다시 모바일 앱으로 알림을 보내주는 방식이다.</p>
<p>바로 우리의 관리자 웹페이지에서 OneSiganl API로 보내는 코드에, 다음과 같이 priority 속성을 넣어주었다.</p>
<pre><code class="language-json">{
  &quot;app_id&quot;: &quot;YOUR_APP_ID&quot;,
  &quot;included_segments&quot;: [&quot;All&quot;],
  ... 중략 ...
  &quot;priority&quot;: 10
}
</code></pre>
<p>그러니 푸시 알림이 모든 휴대폰에 바로바로 가기 시작했다.</p>
<p>아마 채팅 기능을 만드는 등 신속한 푸시 알림이 필요하면, 이 우선순위 속성을 알고있어야 할 것이다.</p><div class="comments-wrapper"><div>Loading script...</div><div></div></div></main></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/blog/ajou-univ-mogakko-fourth-day-2024-02-08/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-ed341744e62779156dac.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-e3f2f4d4748625131e2c.js\"],\"component---src-pages-about-js\":[\"/component---src-pages-about-js-0f802d031edef6ba5de3.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-간절한목표가필요하다-20230118-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-간절한목표가필요하다-20230118-index-mdx-92a1074683151b264f8b.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-기다리다발견-20230209-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-기다리다발견-20230209-index-mdx-60f8a5cadcedc2cfde4d.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-내인생은반쯤망했다-20230125-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-내인생은반쯤망했다-20230125-index-mdx-7749a77d42ca4fa5e31e.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-너무늦게알게된것-20230220-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-너무늦게알게된것-20230220-index-mdx-73dd1331e619c20ac8a4.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-말과글의힘-20230214-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-말과글의힘-20230214-index-mdx-cfe8f744bb2704976ba2.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-1-서블렛useeffect-20240121-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-1-서블렛useeffect-20240121-index-mdx-0ad051be13e612fdb151.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-2-서블렛useeffect-20240127-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-2-서블렛useeffect-20240127-index-mdx-f69a9d4818c01326a384.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-3-서블렛만능함수-20240204-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-3-서블렛만능함수-20240204-index-mdx-2db5bebe5271fe7875ce.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-4-모바일앱-one-signal-push우선순위-20240208-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-4-모바일앱-one-signal-push우선순위-20240208-index-mdx-5fdd9f2f431bd7f78029.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-5-안드로이드버전강제업데이트도전및-open-ai-sora-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-5-안드로이드버전강제업데이트도전및-open-ai-sora-index-mdx-4ba6f73821b271365500.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-묘한음식이야기-20230313-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-묘한음식이야기-20230313-index-mdx-d451d1895bda1d873827.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-미지의오류를최소화시키는법-20230802-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-미지의오류를최소화시키는법-20230802-index-mdx-32c3f3f91ae3d3f008ee.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-블로그글이왜커밋으로-20230127-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-블로그글이왜커밋으로-20230127-index-mdx-e91cfe3155ac09fed86b.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-빛의속도로-20230225-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-빛의속도로-20230225-index-mdx-2f1d67759527424cfb2b.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-사람들은자신의가치가없다느낄때절망하는가-20230217-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-사람들은자신의가치가없다느낄때절망하는가-20230217-index-mdx-35837df92d4cb0901537.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-삶의낙연등-20230204-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-삶의낙연등-20230204-index-mdx-61bc6110a4106f265b94.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-새로운생산수단의점유자-20230208-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-새로운생산수단의점유자-20230208-index-mdx-d5bd43b936fabc1a279a.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-어떻게시간분배를할것인가-20230113-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-어떻게시간분배를할것인가-20230113-index-mdx-caabae1b7c64af28dd20.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-자기계발이란-20230720-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-자기계발이란-20230720-index-mdx-43851ebfa64a78a87e40.js\"],\"component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-첫글-20221231-index-mdx\":[\"/component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-첫글-20221231-index-mdx-b7937e9089b0f1aa3e1b.js\"],\"component---src-pages-googling-time-line-js\":[\"/component---src-pages-googling-time-line-js-cfac9a1c78d89b2348dc.js\"],\"component---src-pages-guestbook-js\":[\"/component---src-pages-guestbook-js-9781cd1c53e14d5f710d.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-616dfe5b7051eb4f190e.js\"],\"component---src-pages-mogakso-js\":[\"/component---src-pages-mogakso-js-c3d5143634b6d9fef133.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="b36cd18898998043b7de";</script><script src="/webpack-runtime-f0ce549512492997ae30.js" async></script><script src="/framework-18fa0e3ec28c9100171e.js" async></script><script src="/app-ed341744e62779156dac.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>