"use strict";(self.webpackChunkminjae_cho_blog=self.webpackChunkminjae_cho_blog||[]).push([[30],{5575:function(e,t,n){n.r(t),n.d(t,{Head:function(){return d},default:function(){return f}});var a=n(8453),s=n(6540);function c(e){const t=Object.assign({p:"p",span:"span",pre:"pre",code:"code"},(0,a.RP)(),e.components);return s.createElement(s.Fragment,null,s.createElement(t.p,null,"최근 참여하고 있는 프로젝트에서 React로 방 정보를 불러와서 뛰어주는 메인 페이지를 만들어야 하는 일이 있다.\r\n백엔드 만들어주시는 분이 api 방식으로 간단하게 방 정보들 가져올 수 있도록 해주셔서 그걸 적극 활용하였다.\r\n생각나는대로 api가 가져오는 정보를 기존 방 정보랑 결합해주도록 하는 더보기 버튼을 만드니, 계속해서 방 리스트를 가져올 수가 있었다.\r\n그리고 현재 띄어주는 것과 별개로 미리 다음 방 정보를 가져오는 것이 좋겠다고 같이 모각코를 진행중인 분이 말해주었었는데, 확실히 그렇게하니 더 불러올 방이 있으면 버튼이 활성화되고 없으면 비활성화 되는 기능을 구현하기 쉬웠다."),"\n",s.createElement(t.p,null,"일단 이런 식으로 생각나는 대로 기능을 구현했더니, 그대로 바로 동작했다.\r\n그래서 바로 commit 하고 GitHub로 push하였으나.. 여기서 문제가 발생했다."),"\n",s.createElement(t.p,null,s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/cf99346e58295e839c06e8150e21c6e5/8de58/screenshot1.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 27.999999999999996%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAA7klEQVR42o2OSU7FMBBEfWGugBB7hOAEbGAPSw6AOAT8H3C+M4ISJ5HnFN0WWYDEUNKTu9Xl6hayLBFCwLIsmKYJ1jloer33GMcRwzDk2loLpWq0XYe6aqCqGv3bOxz5eR5jzK84v7hE1/fQekRVVfnjQR2yQUqJoihy7ZzH826P4lVit39BQ8Fb4LqumOcZPeUIDuBkvpLZtvGlxgdYwpBnMRbGBTjqE83jp58DmZRSRnD6d1iN9ji5kzglzu4Vjm9LQuLqoaXpVy9r6wV+UIgrFpfw1Boc3RS4fuzgQoI2Eb9J4A/xEcanvOA/+gC1T81TnGePXQAAAABJRU5ErkJggg==\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="스크린샷1"\n        title=""\n        src="/static/cf99346e58295e839c06e8150e21c6e5/0b533/screenshot1.png"\n        srcset="/static/cf99346e58295e839c06e8150e21c6e5/fac75/screenshot1.png 125w,\n/static/cf99346e58295e839c06e8150e21c6e5/63868/screenshot1.png 250w,\n/static/cf99346e58295e839c06e8150e21c6e5/0b533/screenshot1.png 500w,\n/static/cf99346e58295e839c06e8150e21c6e5/1d69c/screenshot1.png 750w,\n/static/cf99346e58295e839c06e8150e21c6e5/00d43/screenshot1.png 1000w,\n/static/cf99346e58295e839c06e8150e21c6e5/8de58/screenshot1.png 1219w"\n        sizes="(max-width: 500px) 100vw, 500px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\r\n그냥 이렇게 떠버리는 것이 아닌가?"),"\n",s.createElement(t.p,null,s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/8101f0a06008d3bab74a5e2f66f4f856/3096d/screenshot2.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 64.8%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAA7DAAAOwwHHb6hkAAADRElEQVR42m2T7U9bdRTH73v/Bf8GX5iYmJj4XiNmmWTZNNnETAhzQ100StSZsIWZjKcO+sBTW6QFCpc+0Q7ay6MtBCgtlAu0wIqjg9ExU1JpHbT0frwws2RxJzk5L845+Z3z+5yvwGtMUV5Eaf0ftIEMtkgWw8wh2uks8l7hLFdUeK0JC4FRurT1dGh1dLaaEe1+XFKY9dgaU1OT+PwS4+NjjPlHeODsZ2ZqjA05TLe+nk6dlg6DkX6bB/tIiNXVOIIouqnTmGi430mzcQhtzwwGR5Rhp0ib0US7zU693oDVYsSiuYW54Vek0Ul+a2inqcXI/fZBmn8fR++M4R3yIthHpvlJ66Krd1Cdzo21fxiXb47RYS+3a+9Q39iArlmD1WSgpuoyLTU3Cc7L/Kixo+924HS6MFtd6lYLjEkSQlO7ibc/+pjyG19SWXmN86UX+KLsKh6HyM0rpfxyrYzLH7zHJ++/xbtvvkF1xac4RyTeKTnHpfIrfFt1nXNqz8ULl3DZBxHkWBzLQA+jox4CwSDhpSix1WUebz9iUvIxNzunFg4wNuJh2udCDs2QeJTEItrwDDv4IxhgfmmZ5eVFUqk9hL8zGXLZHPn8yUu6LygqHD8/4iibRSkWXyFZOD7m5Eh1NVJUqSsn/52GguDyeNX/6yOqElpcWSO2sYUc3yCdPuBZfJ3IgEikVUO818xar4mEb5jnmSybk1OEus1EDQ1suUWWTHrSiS0VimsIk7WPiLxGKLrC6kZC9YfspfZZmfDhNzTibqwj5Paw6LUTtHTyLPWUgKWDB+q5eTRNJBbC+DS1bMsygsfrpcNkRlJftKnTWEUHxh4bm/EYtrpa3N+fp6uiBOudGmy3ruPT15GIhNB/fRXfdx+iq/gMr66Rjq8usjEbRNiMycxO+umzdtFi0NLc2sbnlRUsRxfZWQqzpPuBieoSwvfu4q+uYqb1Hpmnu6wMiczfLkX6uZzFurs4viljJzSFsL+/TzKZJLm9TfrggON8nsPcIdlclic7OzxJ/slWcpdMJodSKJyBOFDrdtQrSO1uc5BOU1R78qeg1CgUVYKnRF9BfKZn5Yxu4aRIW+AvJtYPX2r4NHfapyj/F/S/EfRModCO1aMAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="스크린샷2"\n        title=""\n        src="/static/8101f0a06008d3bab74a5e2f66f4f856/0b533/screenshot2.png"\n        srcset="/static/8101f0a06008d3bab74a5e2f66f4f856/fac75/screenshot2.png 125w,\n/static/8101f0a06008d3bab74a5e2f66f4f856/63868/screenshot2.png 250w,\n/static/8101f0a06008d3bab74a5e2f66f4f856/0b533/screenshot2.png 500w,\n/static/8101f0a06008d3bab74a5e2f66f4f856/1d69c/screenshot2.png 750w,\n/static/8101f0a06008d3bab74a5e2f66f4f856/00d43/screenshot2.png 1000w,\n/static/8101f0a06008d3bab74a5e2f66f4f856/3096d/screenshot2.png 1319w"\n        sizes="(max-width: 500px) 100vw, 500px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\r\n버튼을 한번 눌러주어야 내가 기대한 최초의 화면이 나와버린다\r\n최초 실행 시에도 방 정보를 받아와야 하는데, 버튼을 눌러야 방 정보가 나오는 불친절한 사이트가 되어버린 것이다!"),"\n",s.createElement(t.p,null,"문제의 코드는 바로 이랬다."),"\n",s.createElement(t.pre,null,s.createElement(t.code,{className:"language-js"},"  useEffect(() => {\r\n    fetchRooms(listRoomAmount, listPageAmount);\r\n  }, []);\n")),"\n",s.createElement(t.p,null,"fetch해서 받아온 데이터가 채워져있을 변수를 console.log로 찍어봤더니, 아무것도 없었다.\r\n분명 최초 실행 시에도 방 정보를 받아와야 하는데, 받아오지 못하는 것이다.\r\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/9422b1b44a159417fa3182a555f50cec/b1cde/screenshot3.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 8.8%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAPklEQVR42p3MsQqAMBAE0fz/b6oIkqwuZ2EEb7Sz1oHXTtG60ZqwgwSu/CYfw3Iw1s6sk2IbSUTs/G2q7/AGqNuc/Q+yhMkAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="스크린샷3"\n        title=""\n        src="/static/9422b1b44a159417fa3182a555f50cec/0b533/screenshot3.png"\n        srcset="/static/9422b1b44a159417fa3182a555f50cec/fac75/screenshot3.png 125w,\n/static/9422b1b44a159417fa3182a555f50cec/63868/screenshot3.png 250w,\n/static/9422b1b44a159417fa3182a555f50cec/0b533/screenshot3.png 500w,\n/static/9422b1b44a159417fa3182a555f50cec/b1cde/screenshot3.png 537w"\n        sizes="(max-width: 500px) 100vw, 500px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}})),"\n",s.createElement(t.p,null,"그래서 일단 머리를 스친 것은, useEffect가 제때 정보를 못 받아 온 것을 그냥 무시해버리고 있다는 느낌이었다.\r\n과거 react-native 웹뷰 관련 프로젝트를 할 때, gps 정보를 가져온 후에 웹페이지에 있는 js코드를 실행해야 했는데, 이 개념을 잘 몰라서 많이 헤맨적이 있었다.\r\n또한 저번 학기 운영체제 시간에 언급했던 프로젝트 때문에 관심을 가지게 된 동기, 비동기와 관련된 문제인 것 같아 어떻게 검색해서 정보를 알아볼 지 감이 잡혔다.\r\n동기화는 아예 작업을 순차적으로 해버리기 때문에 블록킹 방식과 같다 볼 수 있고, 논블록킹 방식은 작업이 끝날 때까지 기다리지 않는다고 들었었다.\r\n그러면 지금 useEffect는 논블로킹으로 작동 하고있는 것인가? 그래서 바로 구글에 리액트 useEffect 동기화라는 키워드로 검색해보았다.\r\n근데 검색해보니 async, 비동기를 사용하라고 한다.\r\n생각해보면 지금 방 정보를 얻어오는 api에다가 fetch 함수로 데이터를 가져오고 있는데, 당연히 동기나 비동기로 가져와야 했다.\r\n근데 동기화를 하기엔 데이터 받아올 때까지 사용자의 웹페이지가 멈춰있을 수는 없지 않은가?\r\n그래서 비동기로 동작하는 것이 당연한 것이 아닌가 나름대로 생각하며 바로 useEffect에서 async를 사용해버렸다."),"\n",s.createElement(t.pre,null,s.createElement(t.code,{className:"language-js"},'  useEffect(() => {\r\n    async function fetchData() {\r\n      const res = await fetch(process.env.REACT_APP_BACKEND_URL + "/post" + `?maxPost=${listRoomAmount}&page=${listPageAmount}`);\r\n      const data = await res.json();\r\n      setPreRoomsData(data);\r\n      setRoomsData([...roomsData, ...data]);\r\n    }\r\n    fetchData();\r\n  }, []);\n')),"\n",s.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<span\n      class="gatsby-resp-image-wrapper"\n      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 500px; "\n    >\n      <a\n    class="gatsby-resp-image-link"\n    href="/static/189fec689d0ce6d736d93214a02ac8d1/eb2ef/screenshot4.png"\n    style="display: block"\n    target="_blank"\n    rel="noopener"\n  >\n    <span\n    class="gatsby-resp-image-background-image"\n    style="padding-bottom: 60%; position: relative; bottom: 0; left: 0; background-image: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAMCAYAAABiDJ37AAAACXBIWXMAAA7DAAAOwwHHb6hkAAADLElEQVR42lWQ60+aZxjG379lf8M+dck+Lk2apcuyT4tZ1SVrFpu2utlZD7iupRrWacEDHhDeekJFRTygoKM2qGDLmHJQ0Uo8tQgveACtU4HfXsyWZXdy5blzPfd13VduwT7Sx9OHxTyp/gWVqhlt+zB60xx/ejyMmU2MjZixjg4zJc9ZelqZtvTjemlHVVGCskpBbY2GJq0R3cACLtcigs3hps04TafRQs+Ik86xJQZmt7CPmdEaOtGbJ1EbuhFFHQNaJWJdNbPO17T1ORB7LfQO/45ofs3QgsTk+DhC95CNgnIN9U2t6HQi6iY9PSY7NusEZaV3Uf5cjkalpKFWQck3n/Os8i72WRe3yjQ8qW9B1BuoU7fRMzQja6wIhoFBPsv7mtKKYsoeVnIrv4DSkvvM2KxUFeVTp/iJ219dJ+/6NW5+/BFPHxQx5XjFjcICvv+xiOrKcvILv+XO7e+wTcgJ995HmF9cwB/wshkO8y6yjyRFScTj+H3LrIZC/OH1sra2ws5miMjeNu/2YzgXXXh9HtY337IXixOVYiRTKYTd3V22tnc4Ok5x+uGM8/MLzmRcXFxwcnBEcn+f7KFE9kAifXyMPMBfpyecSAnO5aWZeIR0PMrl0SFZWSP0D5lp0Yt4/UE8ywH8axv4VteJJxJEln04RRGHspKA2IpP1BIYNvHh+IQV2xTT6nrmaip5O2LCpa5FCm0gmMcm6Ogy4vEFcHuXWVoJEVjfJConmzMZmXquYFT9G/OWCdyjfTh7O3i/tcNkQw32xhrMzzUE3YuMqx+z7fcjzMxM0931Aqu80dDZSXOHgVpNI6FggMFGNZYfvsCQ9wn9VRX0FudjUysJL3vRld3DeudTWgq+ZFz1mPbCm6y7XiGEN0K8mZ/FZOzCIBt39/fzQFHBymqQWNBHqEfFUvN9wi9acTf8im9QJBWLEH45iU97T+YesSG243j2iFjAg3BweEQsJpFMJrlMp8lms+TqXD5+VJKIJg54s3PK7tHlFZ/7PTxOEonGOEimOLv4j8/IEPincj45s0wmc4V/jTPya/LE8W6lrmSZdAb+LyKb08hhcv3fY5QDXfFhUGAAAAAASUVORK5CYII=\'); background-size: cover; display: block;"\n  ></span>\n  <img\n        class="gatsby-resp-image-image"\n        alt="스크린샷4"\n        title=""\n        src="/static/189fec689d0ce6d736d93214a02ac8d1/0b533/screenshot4.png"\n        srcset="/static/189fec689d0ce6d736d93214a02ac8d1/fac75/screenshot4.png 125w,\n/static/189fec689d0ce6d736d93214a02ac8d1/63868/screenshot4.png 250w,\n/static/189fec689d0ce6d736d93214a02ac8d1/0b533/screenshot4.png 500w,\n/static/189fec689d0ce6d736d93214a02ac8d1/1d69c/screenshot4.png 750w,\n/static/189fec689d0ce6d736d93214a02ac8d1/00d43/screenshot4.png 1000w,\n/static/189fec689d0ce6d736d93214a02ac8d1/eb2ef/screenshot4.png 1324w"\n        sizes="(max-width: 500px) 100vw, 500px"\n        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"\n        loading="lazy"\n        decoding="async"\n      />\n  </a>\n    </span>'}}),"\n",s.createElement(t.p,null,"그러니 잘 동작한다."))}var r=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,a.RP)(),e.components);return t?s.createElement(t,e,s.createElement(c,e)):c(e)},i=n(3895),l=n(7528),o=n(5240),u=n(9314),m=n(5551);const p={Video:o.A,ExternalLink:u.A},g=e=>{let{data:t,children:n}=e;return s.createElement(i.A,{pageTitle:t.mdx.frontmatter.title},s.createElement(a.xA,{components:p},n,s.createElement(m.A)))},d=e=>{let{data:t}=e;return s.createElement(l.A,{title:t.mdx.frontmatter.title})};function f(e){return s.createElement(g,e,s.createElement(r,e))}},5551:function(e,t,n){var a=n(5540),s=n(6540);let c=function(e){function t(t){var n;return(n=e.call(this,t)||this).commentsEl=s.createRef(),n.state={status:"pending"},n}(0,a.A)(t,e);var n=t.prototype;return n.componentDidMount=function(){const e=document.createElement("script");e.onload=()=>this.setState({status:"success"}),e.onerror=()=>this.setState({status:"failed"}),e.async=!0,e.src="https://utteranc.es/client.js",e.setAttribute("repo","ussr1285/ussr1285.github.io"),e.setAttribute("issue-term","title"),e.setAttribute("theme","github-light"),e.setAttribute("crossorigin","anonymous"),this.commentsEl.current.appendChild(e)},n.render=function(){const{status:e}=this.state;return s.createElement("div",{className:"comments-wrapper"},"failed"===e&&s.createElement("div",null,"Error. Please try again."),"pending"===e&&s.createElement("div",null,"Loading script..."),s.createElement("div",{ref:this.commentsEl}))},t}(s.Component);t.A=c},9314:function(e,t,n){var a=n(6540),s=n(9216);t.A=e=>{let{URL:t,children:n}=e;return a.createElement("a",{href:t,className:s.yX},n)}},3895:function(e,t,n){var a=n(4506),s=n(6540),c=n(4810),r=n(9216);t.A=e=>{let{pageTitle:t,children:n}=e;const i=(0,c.GR)("3159585216");return s.createElement("div",{className:r.kL},s.createElement("header",{className:r.Lu},s.createElement(c.N_,{to:"/",className:r.yX},s.createElement("span",{className:r.q0},i.site.siteMetadata.title)),s.createElement("nav",null,s.createElement("ul",{className:r.rG},(()=>{let e=[];return[["/","Main"],["/about","About"],["https://github.com/ussr1285","Github"],["/guestbook","Guestbook"],["https://minjaegoogling.notion.site/fb5067a26b514e6580519523e319a5f6?pvs=4","My Googling"]].map((t=>{e=[].concat((0,a.A)(e),[s.createElement("li",{className:r.Fw},s.createElement(c.N_,{to:t[0],className:r.yX},t[1]))])})),e})()))),s.createElement("main",null,s.createElement("h1",{className:r.EF},t),n))}},7528:function(e,t,n){var a=n(6540),s=n(4810);t.A=e=>{let{title:t}=e;const n=(0,s.GR)("3159585216");return a.createElement("title",null,t," | ",n.site.siteMetadata.title)}},5240:function(e,t,n){n.d(t,{A:function(){return s}});var a=n(6540);var s=e=>{let{videoSrcURL:t,videoTitle:n,...s}=e;return a.createElement("div",{className:"video-module--video-wrapper--8f25c"},a.createElement("iframe",{src:t,title:n,allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",frameBorder:"0",webkitallowfullscreen:"true",mozallowfullscreen:"true",allowFullScreen:!0}))}},9216:function(e,t,n){n.d(t,{EF:function(){return l},Fw:function(){return r},Lu:function(){return o},kL:function(){return s},q0:function(){return u},rG:function(){return i},u3:function(){return a},yX:function(){return c}});var a="layout-module--articleStyle--05fbf",s="layout-module--container--78b04",c="layout-module--link-text--246e7",r="layout-module--nav-link-item--a5f0a",i="layout-module--nav-links--1113b",l="layout-module--page-heading--83cb2",o="layout-module--site-header--d0ab8",u="layout-module--site-title--e4dea"},8453:function(e,t,n){n.d(t,{RP:function(){return c},xA:function(){return i}});var a=n(6540);const s=a.createContext({});function c(e){const t=a.useContext(s);return a.useMemo((()=>"function"==typeof e?e(t):{...t,...e}),[t,e])}const r={};function i({components:e,children:t,disableParentContext:n}){let i;return i=n?"function"==typeof e?e({}):e||r:c(e),a.createElement(s.Provider,{value:i},t)}}}]);
//# sourceMappingURL=component---src-pages-blog-mdx-frontmatter-slug-js-content-file-path-blog-모각소-1-서블렛useeffect-20240121-index-mdx-987d64e7ed1a865f872d.js.map